---
title: "EDA buscas"
output: html_notebook
---

O objeto principal da análise são as buscas e a navegação depois da busca. Criamos esses dados a partir dos dados originais da wikimedia em `/data/search_data.csv`. 

Aqui, exploramos esses dados. 

```{r setup}
library(tidyverse)
library(here)
library(lubridate)
theme_set(theme_bw())
```

```{r ETL}
buscas = read_csv(here::here("data/search_data.csv"))
```

```{r}
search_date <- buscas %>%
        mutate(d_busca = format(session_start_date, "%Y-%m-%d"))
```

```{r}
count_clicks_filter <- buscas %>%
    group_by(first_click) %>%
    summarise(count_clicks = n()) %>%
    arrange(desc(count_clicks))  %>%
    top_n(20)
```

### What is our daily overall clickthrough rate? How does it vary between the groups?

```{r}
search_date %>%
    filter(num_clicks > 0) %>%
    ggplot(aes(y = num_clicks, x = d_busca)) +
    geom_jitter() +
    scale_y_continuous() +
    labs(x="Search date", y="Number of clicks")
```

### Which results do people tend to try first? How does it change day-to-day?

```{r}
count_clicks_filter %>%
    filter(first_click != "NA") %>%
    ggplot(aes(x = first_click, y = count_clicks)) +
    geom_point() +
        labs(y="Number of clicks", x="Result position")
```

### What is our daily overall zero results rate? How does it vary between the groups?
### Let session length be approximately the time between the first event and the last event in a session. Choose a variable from the dataset and describe its relationship to session length. Visualize the relationship.
### Summarize your findings in an executive summary.